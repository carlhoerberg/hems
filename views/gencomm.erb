# TYPE genset_voltage gauge
# TYPE genset_current gauge
# TYPE genset_kw gauge
# TYPE genset_kva gauge
# TYPE genset_kvar gauge
# TYPE genset_load_pct gauge
<%[1, 2, 3].each do |l|%>
genset_voltage{name="<%=name%>",L="<%=l%>"} <%=measurements["voltage_l#{l}_n".to_sym]%>
genset_current{name="<%=name%>",L="<%=l%>"} <%=measurements["current_l#{l}".to_sym]%>
genset_kw{name="<%=name%>",L="<%=l%>"} <%=measurements["watts_l#{l}".to_sym] / 1000.0%>
genset_kva{name="<%=name%>",L="<%=l%>"} <%=measurements["kva_l#{l}".to_sym]%>
genset_kvar{name="<%=name%>",L="<%=l%>"} <%=measurements["kvar_l#{l}".to_sym]%>
genset_load_pct{name="<%=name%>",L="<%=l%>"} <%=measurements["load_pct_l#{l}".to_sym]%>
<%end%>

# TYPE genset_current_earth gauge
genset_current_earth{name="<%=name%>"} <%=measurements[:current_earth]%>
# TYPE genset_frequency gauge
genset_frequency{name="<%=name%>"} <%=measurements[:frequency]%>
# TYPE genset_rpm gauge
genset_rpm{name="<%=name%>"} <%=measurements[:rpm]%>
# TYPE genset_battery_voltage gauge
genset_battery_voltage{name="<%=name%>"} <%=measurements[:battery_voltage]%>
# TYPE genset_fuel_level gauge
genset_fuel_level{name="<%=name%>"} <%=measurements[:fuel_level]%>
# TYPE genset_fuel_temperature gauge
genset_fuel_temperature{name="<%=name%>"} <%=measurements[:fuel_temperature]%>
# TYPE genset_water_in_fuel gauge
genset_water_in_fuel{name="<%=name%>"} <%=measurements[:water_in_fuel]%>
# TYPE genset_coolant_temperature gauge
genset_coolant_temperature{name="<%=name%>"} <%=measurements[:coolant_temperature]%>
# TYPE genset_oil_pressure gauge
genset_oil_pressure{name="<%=name%>"} <%=measurements[:oil_pressure]%>
# TYPE genset_oil_temperature gauge
genset_oil_temperature{name="<%=name%>"} <%=measurements[:oil_temperature]%>
# TYPE genset_turbo_pressure gauge
genset_turbo_pressure{name="<%=name%>"} <%=measurements[:turbo_pressure]%>
# TYPE genset_atmospheric_pressure gauge
genset_atmospheric_pressure{name="<%=name%>"} <%=measurements[:atmospheric_pressure]%>
# TYPE genset_injector_rail_pressure gauge
genset_injector_rail_pressure{name="<%=name%>"} <%=measurements[:injector_rail_pressure]%>
# TYPE genset_ambient_air_temp gauge
genset_ambient_air_temp{name="<%=name%>"} <%=measurements[:ambient_air_temp]%>
# TYPE genset_air_intake_temp gauge
genset_air_intake_temp{name="<%=name%>"} <%=measurements[:air_intake_temp]%>
# TYPE genset_fuel_consumption gauge
genset_fuel_consumption{name="<%=name%>"} <%=measurements[:fuel_consumption]%>
# TYPE genset_aftertreatment_temp gauge
genset_aftertreatment_temp{name="<%=name%>"} <%=measurements[:aftertreatment_temp]%>
# TYPE genset_aftertreatment_temp_t3 gauge
genset_aftertreatment_temp_t3{name="<%=name%>"} <%=measurements[:aftertreatment_temp_t3]%>
# TYPE genset_engine_reference_torque gauge
genset_engine_reference_torque{name="<%=name%>"} <%=measurements[:engine_reference_torque]%>
# TYPE genset_engine_torque_pct gauge
genset_engine_torque_pct{name="<%=name%>"} <%=measurements[:engine_torque_pct]%>
# TYPE genset_soot_load gauge
genset_soot_load{name="<%=name%>"} <%=measurements[:soot_load]%>
# TYPE genset_ash_load gauge
genset_ash_load{name="<%=name%>"} <%=measurements[:ash_load]%>
# TYPE genset_dpf_regen_status gauge
genset_dpf_regen_status{name="<%=name%>"} <%=measurements[:dpf_regen_status]%>
# TYPE genset_dptc_filter_status gauge
genset_dptc_filter_status{name="<%=name%>"} <%=dpf_status[:dptc_filter_status]%>
# TYPE genset_dpf_soot_mass gauge
genset_dpf_soot_mass{name="<%=name%>"} <%=measurements[:dpf_soot_mass]%>
# TYPE genset_air_mass_flow_rate gauge
genset_air_mass_flow_rate{name="<%=name%>"} <%=measurements[:air_mass_flow_rate]%>
# TYPE genset_dpf_diff_pressure gauge
genset_dpf_diff_pressure{name="<%=name%>"} <%=measurements[:dpf_diff_pressure]%>
# TYPE genset_pct_full_power gauge
genset_pct_full_power{name="<%=name%>"} <%=measurements[:pct_full_power]%>
# TYPE genset_pct_full_var gauge
genset_pct_full_var{name="<%=name%>"} <%=measurements[:pct_full_var]%>
# TYPE genset_kwh counter
genset_kwh{name="<%=name%>"} <%=accumulated[:kwh_positive]%>
# TYPE genset_start_counter counter
genset_start_counter{name="<%=name%>"} <%=accumulated[:start_counter]%>
# TYPE genset_fuel_used counter
genset_fuel_used{name="<%=name%>"} <%=accumulated[:fuel_used]%>
# TYPE genset_hours gauge
genset_hours{name="<%=name%>"} <%=accumulated[:engine_hours]%>
# TYPE genset_trip_fuel counter
genset_trip_fuel{name="<%=name%>"} <%=measurements[:trip_fuel]%>
# TYPE genset_trip_average_fuel gauge
genset_trip_average_fuel{name="<%=name%>"} <%=measurements[:trip_average_fuel]%>
# TYPE genset_trip_avg_fuel_efficiency gauge
genset_trip_avg_fuel_efficiency{name="<%=name%>"} <%=measurements[:trip_avg_fuel_efficiency]%>
# TYPE genset_instantaneous_fuel_efficiency gauge
genset_instantaneous_fuel_efficiency{name="<%=name%>"} <%=measurements[:instantaneous_fuel_efficiency]%>
# TYPE genset_status gauge
genset_status{name="<%=name%>"} <%=status%>

# TYPE metrics_gather_time gauge
metrics_gather_time{device="gencomm"} <%=Process.clock_gettime(Process::CLOCK_MONOTONIC) - t%>
